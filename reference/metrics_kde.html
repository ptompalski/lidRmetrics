<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Kernel density estimation (KDE) metrics — metrics_kde • lidRmetrics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Kernel density estimation (KDE) metrics — metrics_kde"><meta name="description" content="Kernel density estimation applied to the distribution of point cloud elevation (Z). KDE allows to
create a probability density function (using a Guassian kernel). The density function is then used to detect
peaks (function maxima). Based on similar metric available in Fusion (see references), with significant differences
in the list of output statistics as well as the default bandwidth used when estimating kernel density."><meta property="og:description" content="Kernel density estimation applied to the distribution of point cloud elevation (Z). KDE allows to
create a probability density function (using a Guassian kernel). The density function is then used to detect
peaks (function maxima). Based on similar metric available in Fusion (see references), with significant differences
in the list of output statistics as well as the default bandwidth used when estimating kernel density."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lidRmetrics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Custom_metric_sets.html">Custom metric sets</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Kernel density estimation (KDE) metrics</h1>

      <div class="d-none name"><code>metrics_kde.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Kernel density estimation applied to the distribution of point cloud elevation (Z). KDE allows to
create a probability density function (using a Guassian kernel). The density function is then used to detect
peaks (function maxima). Based on similar metric available in Fusion (see references), with significant differences
in the list of output statistics as well as the default bandwidth used when estimating kernel density.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">metrics_kde</span><span class="op">(</span><span class="va">z</span>, bw <span class="op">=</span> <span class="fl">2</span>, zmin <span class="op">=</span> <span class="cn">NA</span>, npeaks <span class="op">=</span> <span class="fl">4</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="va">.metrics_kde</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>An object of class <code>formula</code> of length 2.</p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>Z coordinate of the point cloud (point heights)</p></dd>


<dt id="arg-bw">bw<a class="anchor" aria-label="anchor" href="#arg-bw"></a></dt>
<dd><p>Numeric. Smoothing bandwidth of the <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">stats::density</a></code> function. Note that the default value (<code>bw=2</code>) does not
correspond to the default <code>bw</code> parameter in <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">stats::density</a></code>.</p></dd>


<dt id="arg-zmin">zmin<a class="anchor" aria-label="anchor" href="#arg-zmin"></a></dt>
<dd><p>numeric. Minimum <code>z</code> value. If set, <code>z</code> values (heights) below are ignored in calculations.</p></dd>


<dt id="arg-npeaks">npeaks<a class="anchor" aria-label="anchor" href="#arg-npeaks"></a></dt>
<dd><p>Numeric. Maximum number of recorded peaks. If the number of detected peaks is larger
than <code>npeaks</code>, only the peaks with highest density value are kept.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters of the <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">stats::density</a></code> function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list. Number of peaks, elevation, and density value of each peak, distance (height difference) between peaks</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>McGaughey, R.J., 2021. FUSION/LDV: Software for LIDAR Data Analysis and Visualization. http://forsys.cfr.washington.edu/software/fusion/FUSION_manual.pdf</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lidar/lidR" class="external-link">lidR</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ptompalski.github.io/lidRmetrics/">lidRmetrics</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">LASfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Megaplot.laz"</span>, package<span class="op">=</span><span class="st">"lidR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">las</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lidR/man/readLAS.html" class="external-link">readLAS</a></span><span class="op">(</span><span class="va">LASfile</span>, select <span class="op">=</span> <span class="st">"*"</span>, filter <span class="op">=</span> <span class="st">"-keep_random_fraction 0.5"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lidR/man/aggregate.html" class="external-link">cloud_metrics</a></span><span class="op">(</span><span class="va">las</span>, <span class="op">~</span><span class="fu">metrics_kde</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lidR/man/aggregate.html" class="external-link">pixel_metrics</a></span><span class="op">(</span><span class="va">las</span>, <span class="op">~</span><span class="fu">metrics_kde</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Z</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Piotr Tompalski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

